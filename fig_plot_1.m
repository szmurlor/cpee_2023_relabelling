close all
% Generate Figure 1 figure from the paper

wyn = [90.6862745098039	79.9019607843137	76.8856447688564	66.6666666666667	60.2469135802469	56.2653562653563	57.1782178217822	41.8719211822660	44.7174447174447	48.8888888888889	33.0024813895782	34.9875930521092	27.7227722772277	27.7641277641278	26.5508684863524	25.3694581280788]
wratio = [0	0.0477941176470588	0.0933823529411765	0.130882352941176	0.179411764705882	0.211764705882353	0.263970588235294	0.297794117647059	0.333088235294118	0.361029411764706	0.394117647058824	0.416176470588235	0.430147058823529	0.481617647058824	0.492647058823529	0.508823529411765]

wyn4 = [86.9135802469136	88.5365853658537	88.1481481481482	85.7843137254902	82.3529411764706	77.6674937965261	82.5436408977556	72.7047146401985	72.2772277227723	67.6470588235294	62.6865671641791	66.9117647058824	64.2679900744417	57.7777777777778	56.5432098765432	52.3456790123457]
wratio4 = [0	0.0500000000000000	0.0985294117647059	0.134558823529412	0.183823529411765	0.220588235294118	0.250000000000000	0.288970588235294	0.322058823529412	0.353676470588235	0.394852941176471	0.415441176470588	0.446323529411765	0.476470588235294	0.512500000000000	0.518382352941177]

wyn5 = [ 85.6435643564357	82.3960880195599	79.2079207920792	83.5784313725490	81.1274509803922	82.9207920792079	80.7881773399015	75.6823821339950	75.3694581280788	72.5490196078431	67.7419354838710	59.8522167487685	66.6666666666667	66.6666666666667	61.4814814814815	59.1022443890274]
wratio5 = [0	0.0455882352941176	0.0955882352941176	0.138235294117647	0.174264705882353	0.212500000000000	0.250000000000000	0.296323529411765	0.322058823529412	0.361029411764706	0.397794117647059	0.429411764705882	0.458823529411765	0.481617647058824	0.500000000000000	0.522794117647059]


figure(1)
hold on
plot(wratio*100, wyn, 'or', wratio*100, wyn,'b')
plot(wratio4*100, wyn4, '+k', wratio4*100, wyn4,'k')
plot(wratio5*100, wyn5, 'db', wratio5*100, wyn5,'b')
grid
legend('original wrong labeled','','corrected - KNN(4)','', 'corrected - KNN(5)', '')
xlabel('% of dataset with wrong labels')
ylabel('Accuracy of recognition')
xtickformat('percentage')
ytickformat('percentage')
hold off



good_labels = 100 * [1	0.954411764705882	0.904411764705882	0.861764705882353	0.825735294117647	0.787500000000000	0.750000000000000	0.703676470588235	0.677941176470588	0.638970588235294	0.602205882352941	0.570588235294118	0.541176470588235	0.518382352941177	0.500000000000000	0.477205882352941]
good_labels_corrected = 100 * [0.929411764705882	0.929411764705882	0.913235294117647	0.906617647058824	0.891911764705882	0.886029411764706	0.871323529411765	0.840441176470588	0.829411764705882	0.815441176470588	0.777205882352941	0.720588235294118	0.738235294117647	0.732352941176471	0.662500000000000	0.652205882352941]


figure(2)
hold on
plot(wratio5, good_labels, 'or', wratio5, good_labels,'b')
plot(wratio5, good_labels_corrected, 'db', wratio5, good_labels_corrected,'b')
grid
legend('no correction','','corrected with KNN(5)','')
title('Agreement of the lables with real labels')
hold off




wynT = [81.7647058823529	79.1176470588235	83.2352941176471	76.4705882352941	77.3529411764706	82.6470588235294	78.5294117647059	79.7058823529412	72.0588235294118	77.6470588235294	62.9411764705882	66.4705882352941	69.4117647058824	59.4117647058824	61.1764705882353	63.8235294117647]
wynVal = [81.0679611650485	81.1808118081181	79.2792792792793	82.0960698689956	80.2083333333333	82.3529411764706	82.8358208955224	83.8235294117647	74.7967479674797	74.8538011695906	70.3883495145631	65.6626506024096	63.2911392405063	58.3333333333333	63.1944444444444	62.3762376237624]
wratioT = [0	0.0470588235294118	0.0980392156862745	0.132352941176471	0.178431372549020	0.219607843137255	0.259803921568627	0.285294117647059	0.317647058823529	0.361764705882353	0.388235294117647	0.425490196078431	0.449019607843137	0.464705882352941	0.500980392156863	0.518627450980392]

figure(3)
hold on
plot(wratioT, wynT, 'or', wratioT, wynT,'b')
plot(wratioT, wynVal, 'db', wratioT, wynVal,'b')
grid
legend('test dataset without wrong labels','','validate dataset','')
title('Agreement of the test dataset with validation dataset')
hold off
